<!doctype html>
<html lang="en">

<head>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
    integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css">
  <link rel="stylesheet" href="styles.css?v=1.0.0">
  <link rel="shortcut icon" href="favicon.png" type="image/x-icon" />
  <title>Putar Lagu</title>
</head>

<body>
  <div id="app" class="wrapper container-fluid" :class="{'dark-mode': mode == 'dark-mode'}" v-cloak>
    <div class="row">
      <div class="col-md-4 border-right-1">
        <div class="d-flex flex-row justify-content-between align-items-center">
          <h1>Putar Lagu</h1>
          <div class="dropdown show">
            <a class="btn btn-outline-info dropdown-toggle" href="#" role="button" id="dropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              <i class="fas fa-cog mr-2"></i>
            </a>
          
            <div class="dropdown-menu" aria-labelledby="dropdownMenuLink">
              <a class="dropdown-item" href="#" v-on:click="toggleMode()">
                <span v-if="mode != 'dark-mode'"><i class="fas fa-moon"></i> Dark Mode</span>
                <span v-if="mode == 'dark-mode'"><i class="far fa-moon"></i> Light Mode</span>
              </a>
            </div>
          </div>
        </div>
        
        <div class="add-queue">
          <div class="input-group mb-3">
            <input type="url" id="url" value="" v-model="searchValue" @focus="onFocus = true" @blur="falseDelay()" autocomplete="off" class="form-control input-url"
              placeholder="Url Youtube" aria-label="Url Youtube" aria-describedby="basic-addon2">
            <div class="input-group-append">
              <button class="btn btn-dark" type="button" onclick="addQueue()" id="btnAddQueue">Add Queue</button>
            </div>
          </div>
          <div v-if="searchResults.length > 0 && onFocus" class="search-list">
            <div v-for="search in searchResults" :key="search.id" class="d-flex flex-row mb-1 search-result" v-on:click="addQueueSearch(search)">
              <img :src="search.snippet.thumbnails.default.url" width="100" class="meta-video-thumb mr-2" />
              <div class="meta-video-detail w-100">
                <h3 class="title">{{ search.title }}</h3>
                <div class="d-flex flex-row align-items-center">
                  <span class="badge badge-dark mr-2">{{ search.duration_raw }}</span>
                  <span class="badge badge-secondary">{{ search.snippet.publishedAt }}</span>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div v-if="!currentPlaying || !state" class="d-flex flex-row align-items-center now-playing my-3">
          <img src="waiting.gif" width="50%" />
          <h3>Waiting...</h3>
        </div>
        <div v-if="currentPlaying && state" class="d-flex flex-column now-playing my-3">
          <div class="animate"></div>
          <div class="state">
            <i class="text-danger fas fa-play"></i>
            {{currentPlaying.addedBy}}
          </div>
          <img :src="currentPlaying.thumbnailVideo" class="img-fluid video-thumb" />
          <div class="playing-info">
            <div class="d-flex justify-content-between align-items-center">
              <div class="flex-grow-1">
                <h3 class="title">{{currentPlaying.title}}</h3>
                <span>{{currentPlaying.author}}</span>
              </div>
              <div class="d-flex flex-column align-items-center" style="min-width: 100px">
                <div v-if="state" class="text-center mb-2">
                  {{state.text}}
                </div>
                <div class="control d-flex flex-row justify-content-between align-content-center">
                  <button v-if="queueList.length > 0" onclick="skip()" class="btn btn-sm btn-danger">Skip</button>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div v-if="users.length > 0" class="users-list my-3">
          Online <br/> 
          <a v-for="user in users" :key="user.id" class="badge badge-warning mr-2">
            <i class="fa fa-user"></i> 
            {{user.name}}
          </a>
        </div>
      </div>
      <div class="col-md-4 border-right-1 mt-2">
        <div class="d-flex justify-content-between">
          <h2 class="flex-grow-1">Queue</h2>
          <button onclick="getQueue()" class="btn btn-link text-info"><i class="fas fa-sync"></i> Refresh</button>
        </div>
        <div v-if="queueList.length < 1">
          <div class="d-flex align-items-center justify-content-center" style="height: 80vh;">
            Waiting...
          </div>
        </div>
        <transition name="fade">
          <div v-if="queueList.length > 0" class="queue-list">
            <a v-for="queue in queueList" :key="queue.idVideo" v-on:click="removeQueueVue(queue)">
              <div class="d-flex align-items-start meta-video slide slide-in mb-2">
                <img :src="queue.thumbnailVideo" width="100" class="meta-video-thumb mr-2" />
                <div class="meta-video-detail w-100">
                  <h3 class="title">{{ queue.title }}</h3>
                  <div class="d-flex flex-row justify-content-between align-items-center">
                    <span class="author">{{ queue.author }}</span>
                    <span class="badge badge-primary mx-2"><i class="fa fa-plus" aria-hidden="true"></i> {{queue.addedBy}}</span>
                  </div>
                  
                </div>
              </div>
            </a>
          </div>
        </transition>
        
      </div>
      <div class="col-md-4 mt-2">
        <div class="d-flex justify-content-between">
          <h2 class="flex-grow-1">History</h2>
          <button v-on:click="randomAddQueue()" class="btn btn-link text-info"><i class="fas fa-random"></i> Add Random</button>
        </div>
        <div v-if="historyList.length < 1">
          <div class="d-flex align-items-center justify-content-center" style="height: 80vh;">
            No History
          </div>
        </div>
        <transition name="fade">
          <div v-if="historyList.length > 0" class="queue-list">
            <a v-for="history in historyList" :key="history.idVideo" v-on:click="addQueueVue(history);">
              <div class="d-flex align-items-start meta-video slide-inverse slide-inverse-in mb-2">
                <img :src="history.thumbnailVideo" width="100" class="meta-video-thumb mr-2" />
                <div class="meta-video-detail w-100">
                  <h3 class="title">{{ history.title }}</h3>
                  <div class="d-flex flex-row justify-content-between align-items-center">
                    <span class="author">{{ history.author }}</span>
                    <span v-if="history.skipBy" class="badge badge-danger mx-2"><i class="fa fa-ban"></i> {{history.skipBy}}</span>
                  </div>
                </div>
              </div>
            </a>
          </div>
        </transition>
        
      </div>
    </div>
  </div>

  <div id="snackbar">Notification</div>

  <!-- Optional JavaScript -->
  <!-- jQuery first, then Popper.js, then Bootstrap JS -->
  <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"
    integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous">
  </script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
    integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous">
  </script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"
    integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous">
  </script>
  <script src="https://cdn.socket.io/4.3.2/socket.io.min.js"
    integrity="sha384-KAZ4DtjNhLChOB/hxXuKqhMLYvx3b5MlT55xPEiNmREKRzeEm+RVPlTnAn0ajQNs" crossorigin="anonymous">
  </script>
  <script src="https://cdn.jsdelivr.net/npm/vue@2.6.14"></script>
  <script src="main.js?v=1.0.0"></script>
</body>

</html>